var pdfObjects={};var globalScope={};function createURL(b){var a=window.location.href;var c=a.split("/");if(c[2].match(/localhost.*/)){a=c[0]+"//"+c[2]+b}else{a=c[0]+"//"+c[2]+"/"+c[3]+b}return a}function emptyDiv(a){if(typeof a==="string"){var b=document.getElementById(a);while(b.hasChildNodes()){b.removeChild(b.lastChild)}}else{if(typeof a==="object"){while(a.hasChildNodes()){a.removeChild(a.lastChild)}}}}function greyFirstSelect(a){if(a.selectedIndex===0){a.style="color: grey"}else{a.style="color: black"}}function goToPage(){var c=document.getElementById("page-select");var b=c.value;if(b===""){alertify.alert("Please Select A Page")}else{var a=createURL("/editpage?page="+b);window.open(a,"_blank")}}function deletePageConfirm(){var b=document.getElementById("page-select");var a=b.value;if(a===""){alertify.alert("Please Select A Page")}else{alertify.confirm("Are You Sure You Want To Delete This Page? This Is Permanent.",function(c){if(c){deletePage(a)}else{}})}}function loadCategories(j){var h=j.options[j.selectedIndex].value;var a=document.getElementById("select-category");emptyDiv(a);var g=document.createElement("option");g.setAttribute("value","");g.innerHTML="choose category";a.appendChild(g);var d=document.getElementById("select-topic");emptyDiv(d);var c=document.createElement("option");c.setAttribute("value","");c.innerHTML="choose topic";d.appendChild(c);if(h!==""){var e=Object.keys(globalScope.subjects[h]);var f=e.length;for(var b=0;b<f;b++){g=document.createElement("option");g.setAttribute("value",e[b]);g.innerHTML=e[b];a.appendChild(g)}a.selectedIndex=0}greyFirstSelect(j);greyFirstSelect(a)}function loadTopics(b){var c=b.options[b.selectedIndex].value;var j=document.getElementById("select-subject");var h=j.options[j.selectedIndex].value;var f=document.getElementById("select-topic");emptyDiv(f);var e=document.createElement("option");e.innerHTML="choose topic";e.setAttribute("value","");f.appendChild(e);if(h!==""&&c!==""){var a=globalScope.subjects[h][c];var g=a.length;for(var d=0;d<g;d++){e=document.createElement("option");e.setAttribute("value",a[d]);e.innerHTML=a[d];f.appendChild(e)}f.selectedIndex=0}greyFirstSelect(b);greyFirstSelect(f)}function deparseBlock(a,c){var b=c.replace(/@SP@/g," ").replace(/@HS@/g,"&nbsp;").replace(/@AM@/g,"&").replace(/@DQ@/g,'"').replace(/@SQ@/g,"'").replace(/@CO@/g,",").replace(/@PL@/g,"+").replace(/@BR@/g,"<br>");if(a==="xtext"){}else{if(a==="xcode"){}else{}}return b}function parseBlock(b,c){var a=c.replace(/ /g,"@SP@").replace(/&nbsp;/g,"@HS@").replace(/&/g,"@AM@").replace(/"/g,"@DQ@").replace(/'/g,"@SQ@").replace(/,/g,"@CO@").replace(/\+/g,"@PL@").replace(/<br>/g,"@BR@");if(b==="xtext"){}else{if(b==="xcode"){a=a.replace(/<span[^>]*>/g,"").replace(/<\/span>/g,"")}else{}}return a}function urlEscape(a){a.replace(/\s+/g,"-").replace(/&/g,"and").replace(/'/g,'"');return a}function btnLogOut(){var a=document.createElement("button");a.setAttribute("type","");a.setAttribute("class","menubtn red-btn");a.setAttribute("value","submit-logout");a.setAttribute("onclick","logout();");a.innerHTML="Log Out";return a}function btnProfile(){var a=createURL("/profile");var b=document.createElement("a");b.setAttribute("class","profile-btn");b.setAttribute("href",a);b.setAttribute("target","_blank");b.setAttribute("value","Profile");b.innerHTML="Profile";return b}function btnSubmit(d,c,a){var b=document.createElement("button");b.setAttribute("type","");b.setAttribute("class","menubtn "+a+"-btn");b.setAttribute("value","submit");b.setAttribute("onclick",c+"();");b.innerHTML=d;return b}function dashAutoSave(){var a=document.createElement("div");a.setAttribute("id","autosave");return a}function dashSaveBar(){var a=document.createElement("div");a.setAttribute("id","savebar");return a}function dashSaveStatus(){var a=document.createElement("div");a.setAttribute("id","savestatus");a.innerHTML="Saved";return a}function dashSaveProgress(){var b=document.createElement("div");b.setAttribute("id","saveprogress");var a=document.createElement("progress");a.setAttribute("id","progressbar");a.setAttribute("value",100);a.setAttribute("max",100);a.style.visibility="hidden";a.style.display="none";b.appendChild(a);return b}function displaySignUp(){var b=formSignUp();var a=document.getElementById("content");a.appendChild(b);a.removeChild(document.getElementById("signupbtn"))}function formLogin(){var a=document.createElement("div");a.setAttribute("class","form");a.setAttribute("id","form-login");var d=document.createElement("input");d.setAttribute("type","text");d.setAttribute("name","username-login");d.setAttribute("maxlength","50");d.setAttribute("placeholder","User Name");var b=document.createElement("input");b.setAttribute("type","password");b.setAttribute("name","password-login");b.setAttribute("maxlength","32");b.setAttribute("placeholder","Password");var c=document.createElement("button");c.setAttribute("type","button");c.setAttribute("name","submit-login");c.setAttribute("onclick","login();");c.innerHTML="Log In";a.appendChild(d);a.appendChild(b);a.appendChild(c);return a}function formSignUp(){var h=document.createElement("div");h.setAttribute("class","form");h.setAttribute("id","form-signup");var g=document.createElement("input");g.setAttribute("type","text");g.setAttribute("name","username-signup");g.setAttribute("maxlength","50");g.setAttribute("placeholder","User Name");var e=document.createElement("input");e.setAttribute("type","text");e.setAttribute("name","email-signup");e.setAttribute("maxlength","50");e.setAttribute("placeholder","Email - optional");var a=document.createElement("input");a.setAttribute("type","text");a.setAttribute("name","phone-signup");a.setAttribute("maxlength","15");a.setAttribute("placeholder","Phone - optional");var d=document.createElement("input");d.setAttribute("type","password");d.setAttribute("name","password-signup");d.setAttribute("maxlength","32");d.setAttribute("placeholder","Password");var c=document.createElement("input");c.setAttribute("type","password");c.setAttribute("name","password-signup-check");c.setAttribute("maxlength","32");c.setAttribute("placeholder","Repeat Password");var f=document.createElement("button");f.setAttribute("type","button");f.setAttribute("value","submit-signup");f.setAttribute("onclick","signup();");f.innerHTML="Sign Up";var b=document.createElement("div");b.setAttribute("class","error");b.setAttribute("id","error-signup");h.appendChild(g);h.appendChild(e);h.appendChild(a);h.appendChild(d);h.appendChild(c);h.appendChild(f);h.appendChild(b);return h}function loadTempPage(a){var b=createURL("/editpage?page="+a+"&temp=true");window.location=b}function loadPermPage(a){var b=createURL("/editpage?page="+a+"&temp=false");window.location=b}function progressFinalize(b,a){document.getElementById("progressbar").setAttribute("value",a);document.getElementById("progressbar").style.visibility="hidden";document.getElementById("progressbar").style.display="none";document.getElementById("autosave").style.visibility="visible";document.getElementById("autosave").style.display="block";document.getElementById("savestatus").innerHTML=b}function progressInitialize(b,a){document.getElementById("autosave").style.visibility="hidden";document.getElementById("autosave").style.display="none";document.getElementById("progressbar").setAttribute("value",0);document.getElementById("progressbar").setAttribute("max",a);document.getElementById("progressbar").style.visibility="visible";document.getElementById("progressbar").style.display="block";document.getElementById("savestatus").innerHTML=b}function progressUpdate(a){document.getElementById("progressbar").setAttribute("value",a)}function rowProfileCheck(a,i,h,j){var l=document.createElement("div");l.setAttribute("class","row");var k=document.createElement("div");k.setAttribute("class","col col-15");var d=document.createElement("div");d.setAttribute("class","col col-35 pad-10-left");var f=document.createElement("div");f.setAttribute("class","col col-35 pad-10-right");var c=document.createElement("div");c.setAttribute("class","col col-15");var e=document.createElement("input");e.setAttribute("type","password");e.setAttribute("name",a);e.setAttribute("class","text-input");e.setAttribute("maxlength","50");e.setAttribute("placeholder",h[0]);var b=document.createElement("input");b.setAttribute("type","password");b.setAttribute("name",i);b.setAttribute("class","text-input");b.setAttribute("maxlength","50");b.setAttribute("placeholder",h[1]);var g=document.createElement("button");g.setAttribute("type","button");g.setAttribute("name","save-"+i);g.setAttribute("class","menubtn green-btn");g.setAttribute("onclick",'saveProfileInfo(this,["'+a+'","'+i+'"])');g.innerHTML="Save";k.innerHTML=j;d.appendChild(e);f.appendChild(b);c.appendChild(g);l.appendChild(k);l.appendChild(d);l.appendChild(f);l.appendChild(c);return l}function rowProfileSingle(f,g,c){var i=document.createElement("div");i.setAttribute("class","row");var h=document.createElement("div");h.setAttribute("class","col col-15");var e=document.createElement("div");e.setAttribute("class","col col-70 pad-10");var b=document.createElement("div");b.setAttribute("class","col col-15");var a=document.createElement("input");a.setAttribute("type","text");a.setAttribute("name",f);a.setAttribute("class","text-input");a.setAttribute("maxlength","50");a.setAttribute("value",c);var d=document.createElement("button");d.setAttribute("type","button");d.setAttribute("name","save-"+f);d.setAttribute("class","menubtn green-btn");d.setAttribute("onclick",'saveProfileInfo(this,["'+f+'"])');d.innerHTML="Save";h.innerHTML=g;e.appendChild(a);b.appendChild(d);i.appendChild(h);i.appendChild(e);i.appendChild(b);return i}function pageChoose(f){var j=document.createElement("div");j.setAttribute("class","row");var h=document.createElement("div");h.setAttribute("class","col col-100 pad-10");var i=document.createElement("p");i.innerHTML="You are viewing this because the page was closed without Revert or Save being clicked. Please choose which page you want to save.";h.appendChild(i);j.appendChild(h);var c=document.createElement("div");c.setAttribute("class","row");var l=document.createElement("div");l.setAttribute("class","col col-50 pad-10");var b=document.createElement("div");b.setAttribute("class","col col-50 pad-10");c.appendChild(l);c.appendChild(b);var k=document.createElement("p");k.innerHTML="This is your last temporary save. This save contains the blocks from the last time you added a block.";var e=document.createElement("button");e.setAttribute("type","button");e.setAttribute("class","menubtn green-btn");e.setAttribute("value","submit-temp");e.setAttribute("onclick","loadTempPage("+f+");");e.innerHTML="Temporary Page";var a=document.createElement("p");a.innerHTML="This is you last permanent save. This save contains the blocks from the last time you clicked Save.";var g=document.createElement("button");g.setAttribute("type","button");g.setAttribute("class","menubtn green-btn");g.setAttribute("value","submit-perm");g.setAttribute("onclick","loadPermPage("+f+");");g.innerHTML="Permanent Page";l.appendChild(e);l.appendChild(k);b.appendChild(g);b.appendChild(a);var d=document.getElementById("content");d.appendChild(j);d.appendChild(c)}function pageEdit(z){var Q=document.createElement("div");Q.setAttribute("class","block-menu");var k=document.createElement("div");k.setAttribute("class","row");var F=document.createElement("div");F.setAttribute("class","col col-15");var P=document.createElement("div");P.setAttribute("class","col col-70 pad-10");var y=document.createElement("div");y.setAttribute("class","col col-15");k.appendChild(F);k.appendChild(P);k.appendChild(y);var u=btnLogOut();var r=dashSaveBar();var t=dashSaveProgress();var q=dashSaveStatus();var I=dashAutoSave();var x=document.createElement("div");x.setAttribute("id","saveinfo");x.appendChild(q);t.appendChild(I);r.appendChild(t);r.appendChild(x);var g=btnProfile();var G=z.split(",");var H=G[0];var M=G[1];var A=document.createElement("input");A.setAttribute("type","hidden");A.setAttribute("name","pageid");A.setAttribute("value",H);var U=document.createElement("input");U.setAttribute("type","hidden");U.setAttribute("name","statusid");U.setAttribute("value","1");F.appendChild(u);P.appendChild(r);y.appendChild(g);Q.appendChild(A);Q.appendChild(U);Q.appendChild(k);var D=document.createElement("div");D.setAttribute("class","row");var B=document.createElement("div");B.setAttribute("class","col col-15");var J=document.createElement("div");J.setAttribute("class","col col-70 pad-10");var b=document.createElement("div");b.setAttribute("class","col col-15");D.appendChild(B);D.appendChild(J);D.appendChild(b);var S=document.createElement("button");S.setAttribute("type","button");S.setAttribute("name","revert-blocks");S.setAttribute("class","menubtn green-btn");S.setAttribute("onclick","revertBlocks()");S.innerHTML="Revert";var E=document.createElement("input");E.setAttribute("type","text");E.setAttribute("name","pagename");E.setAttribute("class","page-title");E.setAttribute("maxlength","50");E.setAttribute("value",M);var h=document.createElement("button");h.setAttribute("type","button");h.setAttribute("name","save-blocks");h.setAttribute("class","menubtn green-btn");h.setAttribute("onclick","saveBlocks(true)");h.innerHTML="Save";B.appendChild(S);J.appendChild(E);b.appendChild(h);Q.appendChild(D);var w=document.createElement("div");w.setAttribute("class","blocks");w.setAttribute("id","blocks");var C=blockButtons(0);w.appendChild(C);var L=2;var N=1;while(L<G.length){var l=insertContent(N,G[L],G[L+1]);C=blockButtons(N);var v=document.createElement("div");v.setAttribute("class","block");v.setAttribute("id",N);v.appendChild(l);v.appendChild(C);w.appendChild(v);L+=2;N++}var f=document.createElement("input");f.setAttribute("type","file");f.setAttribute("id","file-select");var T=document.createElement("button");T.setAttribute("type","submit");T.setAttribute("id","upload-button");var e=createURL("/uploadmedia");var a=document.createElement("form");a.setAttribute("id","file-form");a.setAttribute("action",e);a.setAttribute("method","POST");a.style.visibility="hidden";a.appendChild(f);a.appendChild(T);var d=document.getElementById("content");d.appendChild(Q);d.appendChild(w);d.appendChild(a);N=0;var c=countBlocks();while(N<c){document.getElementById("d"+N).style.visibility="visible";N++}document.getElementById("d"+N).style.visibility="hidden";var K=document.getElementsByClassName("xTex");var j=K.length;for(N=0;N<j;N++){K[N].contentDocument.designMode="on"}var O=document.getElementsByTagName("code");var s=O.length;for(N=0;N<s;N++){renderCode(O[N])}var p=document.getElementsByClassName("xmath");var m=p.length;for(N=0;N<m;N++){insertMath(p[N])}var R=document.getElementsByClassName("latex");var n=R.length;for(N=0;N<n;N++){insertLatex(R[N])}autosaveTimer(I);var o=getUserFields(["defaulttext"]);o.then(function(i){if(i.defaulttext){globalScope.defaulttext=true}else{globalScope.defaulttext=false}},function(i){globalScope.defaulttext=false;alertify.alert("Error. Default Text Could Not Be Initiated.")});window.onbeforeunload=function(){var i=document.getElementsByName("statusid")[0].value;if(i==0){return"Please click Revert or Save before exiting."}return null}}function pageError(c){var b=document.createElement("div");if(c==="noeditloggedout"){b.innerHTML="You Cannot Edit The Requested Page Because You Are Logged Out."}else{if(c==="notfound"){b.innerHTML="There URL You Requested Does Not Exist"}}var a=document.getElementById("content");a.appendChild(b)}function pageHome(){var m=document.createElement("div");m.setAttribute("class","row");var n=document.createElement("div");n.setAttribute("class","col col-15");var b=document.createElement("div");b.setAttribute("class","col col-70 pad-10");var q=document.createElement("div");q.setAttribute("class","col col-15");m.appendChild(n);m.appendChild(b);m.appendChild(q);var t=btnLogOut();var e=btnProfile();n.appendChild(e);q.appendChild(t);var l=document.createElement("div");l.setAttribute("class","row");var r=document.createElement("div");r.setAttribute("class","col col-33");var j=document.createElement("div");j.setAttribute("class","col col-33");var c=document.createElement("div");c.setAttribute("class","col col-33");l.appendChild(r);l.appendChild(j);l.appendChild(c);var d=document.createElement("select");d.setAttribute("id","select-subject");d.setAttribute("onchange","loadCategories(this);");d.style="color: grey";var g=document.createElement("select");g.setAttribute("id","select-category");g.setAttribute("onchange","loadTopics(this);");g.style="color: grey";var p=document.createElement("select");p.setAttribute("id","select-topic");p.setAttribute("onchange","greyFirstSelect(this);");p.style="color: grey";var h=getSubjects();h.then(function(B){var C=JSON.parse(B);globalScope.subjects=C;var A=Object.keys(C);var y=A.length;var v=document.createElement("option");v.innerHTML="choose subject";v.setAttribute("value","");d.appendChild(v);for(var w=0;w<y;w++){v=document.createElement("option");v.setAttribute("value",A[w]);v.innerHTML=A[w];d.appendChild(v)}var z=document.createElement("option");z.innerHTML="choose category";g.appendChild(z);var x=document.createElement("option");x.innerHTML="choose topic";p.appendChild(x)},function(v){console.log("getSubjects promise error: "+v)});r.appendChild(d);j.appendChild(g);c.appendChild(p);var s=document.createElement("div");s.setAttribute("class","row");var a=document.createElement("div");a.setAttribute("class","col col-85");var o=document.createElement("div");o.setAttribute("class","col col-15");s.appendChild(a);s.appendChild(o);var u=document.createElement("input");u.setAttribute("type","text");u.setAttribute("class","text-input");u.setAttribute("name","pagename-create");u.setAttribute("maxlength","50");u.setAttribute("placeholder","Page Name");var i=btnSubmit("Create Page","createpage","green");a.appendChild(u);o.appendChild(i);var f=document.getElementById("content");f.appendChild(m);f.appendChild(l);f.appendChild(s);var k=getPages();k.then(function(x){var C=x.split(",");var E=document.createElement("div");E.setAttribute("class","row");var I=document.createElement("div");I.setAttribute("class","col col-100");var y=document.createElement("div");y.setAttribute("class","pagelist");E.appendChild(y);var G=document.createElement("select");G.setAttribute("multiple","true");G.setAttribute("id","page-select");y.appendChild(G);var D;if(C.length===1){D=0}else{D=C.length/2}var z=0;while(D>0){var B=document.createElement("option");B.setAttribute("value",C[z]);B.innerHTML=C[z+1];G.appendChild(B);z+=2;D--}var A=document.createElement("div");A.setAttribute("class","row");var F=document.createElement("div");F.setAttribute("class","col col-80");var w=document.createElement("div");w.setAttribute("class","col col-20");A.appendChild(F);A.appendChild(w);var v=btnSubmit("Go To Page","goToPage","green");var H=btnSubmit("Delete Page","deletePageConfirm","red");F.appendChild(v);w.appendChild(H);f.appendChild(document.createElement("hr"));f.appendChild(E);f.appendChild(A)},function(v){console.log("getPages promise error")})}function pageLanding(){var b=formLogin();var c=document.createElement("button");c.setAttribute("type","button");c.setAttribute("id","signupbtn");c.setAttribute("onclick","displaySignUp();");c.innerHTML="Sign Up";var a=document.getElementById("content");a.appendChild(b);a.appendChild(document.createElement("hr"));a.appendChild(c)}function pageProfile(b){if(b==="err"){console.log("profile error")}else{if(b==="noprofileloggedout"){console.log("profile logged out")}}var n=JSON.parse(b);var d=document.createElement("div");d.setAttribute("class","block-menu");var a=document.createElement("div");a.setAttribute("class","row");var m=document.createElement("div");m.setAttribute("class","col col-15");var k=document.createElement("div");k.setAttribute("class","col col-70 pad-10");var o=document.createElement("div");o.setAttribute("class","col col-15");a.appendChild(m);a.appendChild(k);a.appendChild(o);var p=btnLogOut();m.appendChild(p);d.appendChild(a);var f=document.createElement("div");f.setAttribute("class","profilelist");var e=rowProfileSingle("username","Username:",n.username);var i=rowProfileCheck("currentPass","newPass",["Current Password","New Password"],"Password:");var c=rowProfileSingle("autosave","Auto Save:",n.autosave);var l=rowProfileSingle("defaulttext","Default Text:",n.defaulttext);var j=rowProfileSingle("email","Email:",n.email);var h=rowProfileSingle("phone","Phone:",n.phone);f.appendChild(e);f.appendChild(i);f.appendChild(c);f.appendChild(l);f.appendChild(j);f.appendChild(h);var g=document.getElementById("content");g.appendChild(d);g.appendChild(f)}function countBlocks(){var a=0;var b=true;while(b===true){a++;b=Boolean(document.getElementById(a))}return --a}function generateBlock(a,c){var b=document.createElement("div");b.setAttribute("class",c);b.setAttribute("id","a"+a);return b}function insertContent(n,i,k){var f=generateBlock(n,i);if(i==="xtext"){var h=document.createElement("iframe");h.setAttribute("class","xTex");h.setAttribute("maxlength","1023");f.appendChild(h);setTimeout(function(){var s=document.createElement("link");s.href="http://abaganon.com/css/block.css";s.rel="stylesheet";s.type="text/css";var t=f.childNodes[0].contentDocument;t.open();if(globalScope.defaulttext&&k===""){t.write("You can turn this default text off on your Profile Page.<br><br>Press&nbsp;<kbd>shift</kbd>&nbsp;and&nbsp;<kbd>ctrl</kbd>&nbsp;with the following keys to style text:<br><br><kbd>p</kbd>&nbsp;plain<br><kbd>b</kbd>&nbsp;<b>bold</b><br><kbd>i</kbd>&nbsp;<i>italics</i><br><kbd>h</kbd>&nbsp;<span style='background-color: yellow;'>highlight</span><br><kbd>+</kbd>&nbsp;<sup>superscript</sup><br><kbd>-</kbd>&nbsp;<sub>subscript</sub><br><kbd>a</kbd>&nbsp;<a href='http://abaganon.com/'>anchor link</a><ul><li><kbd>l</kbd>&nbsp;list</li></ul><kbd>j</kbd>&nbsp;justify left<br><i>For the things we have to learn before we can do them, we learn by doing them</i>. -Aristotle &nbsp;<i>I hear and I forget.&nbsp;I&nbsp;see and I remember. I do and I understand</i>. &nbsp;-? &nbsp;<i>If you want to go fast, go it alone. If you want to go far, go together.&nbsp;</i>-? &nbsp;<i>If you can't explain it simply, you don't understand it well enough.&nbsp;</i>-Einstein &nbsp;<i>Age is an issue of mind over matter. If you don't mind, it doesn't matter.</i>&nbsp;-Twain<br><br><kbd>f</kbd>&nbsp;justify full<div style='text-align: justify;'><i style='text-align: start;'>For the things we have to learn before we can do them, we learn by doing them</i><span style='text-align: start;'>. -Aristotle &nbsp;</span><i style='text-align: start;'>I hear and I forget.&nbsp;I&nbsp;see and I remember. I do and I understand</i><span style='text-align: start;'>. &nbsp;-? &nbsp;</span><i style='text-align: start;'>If you want to go fast, go it alone. If you want to go far, go together.&nbsp;</i><span style='text-align: start;'>-? &nbsp;</span><i style='text-align: start;'>If you can't explain it simply, you don't understand it well enough.&nbsp;</i><span style='text-align: start;'>-Einstein &nbsp;</span><i style='text-align: start;'>Age is an issue of mind over matter. If you don't mind, it doesn't matter.</i><span style='text-align: start;'>&nbsp;-Twain</span>")}else{t.write(deparseBlock(i,k))}t.close();f=f.childNodes[0];if(t.addEventListener){t.addEventListener("keydown",detectKey.bind(null,f),false)}else{if(t.attachEvent){t.attachEvent("onkeydown",detectKey.bind(null,f))}else{t.onkeydown=detectKey.bind(null,f)}}},1)}else{if(i==="xcode"){var c=document.createElement("code");c.setAttribute("class","xCde");c.setAttribute("onblur","renderCode(this)");c.contentEditable="true";if(globalScope.defaulttext&&k===""){c.innerHTML="var description = 'Programming languages are auto-detected.';<br>function default(parameter) {<br>&nbsp;&nbsp;&nbsp;&nbsp;var instructions = 'When you click outside the block syntax is highlighted.';<br>&nbsp;&nbsp;&nbsp;&nbsp;alert(parameter + instructions);<br>}<br>default(description);"}else{c.innerHTML=deparseBlock(i,k)}f.appendChild(c);if(c.addEventListener){c.addEventListener("keydown",codeKeys.bind(null,f),false)}else{if(c.attachEvent){c.attachEvent("onkeydown",codeKeys.bind(null,f))}else{c.onkeydown=codeKeys.bind(null,f)}}}else{if(i==="xmath"){var q='<div class="mathImage"></div>';var a;if(globalScope.defaulttext&&k===""){a='<div class="xMat" onblur="renderMath(this);" contenteditable>AsciiMath \\ Mark \\ Up: \\ \\ \\ sum_(i=1)^n i^3=((n(n+1))/2)^2</div>'}else{a='<div class="xMat" onblur="renderMath(this);" contenteditable>'+deparseBlock(i,k)+"</div>"}f.innerHTML=q+a}else{if(i==="latex"){var o='<div class="latexImage"></div>';var l;if(globalScope.defaulttext&&k===""){l='<div class="xLtx" onblur="renderLatex(this);" contenteditable>LaTeX \\ Mark \\ Up: \\quad \\frac{d}{dx}\\left( \\int_{0}^{x} f(u)\\,du\\right)=f(x)</div>'}else{l='<div class="xLtx" onblur="renderLatex(this);" contenteditable>'+deparseBlock(i,k)+"</div>"}f.innerHTML=o+l}else{if(i==="image"){var p=document.createElement("img");p.setAttribute("class","xImg");p.src=k;f.appendChild(p)}else{if(i==="audio"){var r=document.createElement("audio");r.setAttribute("class","xAud");r.volume=0.8;r.setAttribute("controls","controls");var d=document.createElement("source");d.setAttribute("src",k);d.setAttribute("type","audio/mpeg");r.appendChild(d);f.appendChild(r)}else{if(i==="video"){var m=document.createElement("video");m.setAttribute("class","xVid");m.volume=0.8;m.setAttribute("controls","controls");var g=document.createElement("source");g.setAttribute("src",k);g.setAttribute("type","video/mp4");m.appendChild(g);f.appendChild(m)}else{if(i==="xsvgs"){var b=document.createElement("div");b.setAttribute("class","xSvg");b.setAttribute("data-link",k);if(k!==""){getLocalLinkContent(k).then(function(t){var s=t.split("\n");b.innerHTML=s[1]},function(s){})}f.appendChild(b)}else{if(i==="slide"){var e=document.createElement("canvas");e.setAttribute("class","xSli");e.setAttribute("id",k);e.setAttribute("data-page","1");f.appendChild(e);if(k!==""){PDFJS.getDocument(k).then(function(t){pdfObjects[k]=t;var s=f.childNodes[0];renderPDF(t,1,s)})}f.onmouseup=function(u){var x=u.pageX-this.offsetLeft;var t=this.childNodes[0];var v=t.getAttribute("data-page");var w=t.getAttribute("id");var s=pdfObjects[w].numPages;if(x>this.offsetWidth/1.7){if(v<s){v++;t.setAttribute("data-page",v);renderPDF(pdfObjects[w],v,t)}}else{if(v>1){v--;t.setAttribute("data-page",v);renderPDF(pdfObjects[w],v,t)}}}}else{if(i==="title"){var j='<input type="text" class="xTit" maxlength="64" value="'+deparseBlock(i,k)+'">';f.innerHTML=j}}}}}}}}}}return f}function codeKeys(e,b){if(b.keyCode===9){b.preventDefault();var d=e.ownerDocument.defaultView;var c=d.getSelection();var a=c.getRangeAt(0);var f=document.createTextNode("\u00a0\u00a0\u00a0\u00a0");a.insertNode(f);a.setStartAfter(f);a.setEndAfter(f);c.removeAllRanges();c.addRange(a)}}function detectKey(a,b){if(b.shiftKey&&b.ctrlKey&&b.keyCode===80){a.contentDocument.execCommand("removeFormat",false,null)}if(b.shiftKey&&b.ctrlKey&&b.keyCode===66){a.contentDocument.execCommand("bold",false,null)}if(b.shiftKey&&b.ctrlKey&&b.keyCode===73){a.contentDocument.execCommand("italic",false,null)}if(b.shiftKey&&b.ctrlKey&&b.keyCode===72){a.contentDocument.execCommand("backColor",false,"yellow")}if(b.shiftKey&&b.ctrlKey&&b.keyCode===76){a.contentDocument.execCommand("insertUnorderedList",false,null)}if(b.shiftKey&&b.ctrlKey&&b.keyCode===187){a.contentDocument.execCommand("superscript",false,null)}if(b.shiftKey&&b.ctrlKey&&b.keyCode===189){a.contentDocument.execCommand("subscript",false,null)}if(b.shiftKey&&b.ctrlKey&&b.keyCode===74){a.contentDocument.execCommand("justifyLeft",false,null)}if(b.shiftKey&&b.ctrlKey&&b.keyCode===70){a.contentDocument.execCommand("justifyFull",false,null)}if(b.keyCode===9){a.contentDocument.execCommand("insertHTML",false,"&nbsp;&nbsp;&nbsp;&nbsp;")}if(b.shiftKey&&b.ctrlKey&&b.keyCode===65){var c=function(d,e){if(d){if(e.indexOf("http://")<0&&e.indexOf("https://")<0){a.contentDocument.execCommand("createLink",false,"http://"+e)}else{if(e.indexOf("http://")===0||e.indexOf("https://")===0){a.contentDocument.execCommand("createLink",false,e)}else{alertify.log("Not A Valid Link!","error")}}}else{}};alertify.prompt("Enter the link: ",c,"http://")}if(b.shiftKey&&b.ctrlKey&&b.keyCode===88){a.contentDocument.execCommand("cut",false,null)}if(b.shiftKey&&b.ctrlKey&&b.keyCode===67){a.contentDocument.execCommand("copy",false,null)}if(b.shiftKey&&b.ctrlKey&&b.keyCode===86){a.contentDocument.execCommand("paste",false,null)}if(b.shiftKey&&b.ctrlKey&&b.keyCode===90){a.contentDocument.execCommand("undo",false,null)}if(b.shiftKey&&b.ctrlKey&&b.keyCode===89){a.contentDocument.execCommand("redo",false,null)}b.stopPropagation()}function renderCode(a){hljs.highlightBlock(a);if(a.textContent.length>1024){alertify.alert("There is too much in this code block. The block will not save correctly. Please remove some of its content.")}}function renderMath(c){var b="`"+c.textContent+"`";var a=c.parentNode.childNodes[0];a.innerHTML=b;MathJax.Hub.Queue(["Typeset",MathJax.Hub,a])}function renderLatex(c){var b="$$"+c.textContent+"$$";var a=c.parentNode.childNodes[0];a.innerHTML=b;MathJax.Hub.Queue(["Typeset",MathJax.Hub,a])}function renderPDF(a,c,b){var d=0.8;a.getPage(c).then(function(h){var e=h.getViewport(d);b.height=e.height;b.width=e.width;var g={canvasContext:b.getContext("2d"),viewport:e};var f=h.render(g);f.promise.then(function(){})})}function insertMath(c){var b="`"+c.childNodes[1].textContent+"`";var a=c.childNodes[0];a.innerHTML=b;MathJax.Hub.Queue(["Typeset",MathJax.Hub,a])}function insertLatex(c){var b="$$"+c.childNodes[1].textContent+"$$";var a=c.childNodes[0];a.innerHTML=b;MathJax.Hub.Queue(["Typeset",MathJax.Hub,a])}function blockButtons(f){var j=document.createElement("div");j.setAttribute("class","blockbtns");j.setAttribute("id","b"+f);var a=document.createElement("button");a.setAttribute("onclick","addBlock("+f+",'xtext')");a.setAttribute("class","blockbtn addbtn");a.innerHTML="text";var g=document.createElement("button");g.setAttribute("onclick","addBlock("+f+",'xcode')");g.setAttribute("class","blockbtn addbtn");g.innerHTML="code";var m=document.createElement("button");m.setAttribute("onclick","addBlock("+f+",'xmath')");m.setAttribute("class","blockbtn addbtn");m.innerHTML="math";var l=document.createElement("button");l.setAttribute("onclick","addBlock("+f+",'latex')");l.setAttribute("class","blockbtn addbtn");l.innerHTML="latex";var b=document.createElement("button");b.setAttribute("onclick","addBlock("+f+",'image')");b.setAttribute("class","blockbtn addbtn");b.innerHTML="image";var i=document.createElement("button");i.setAttribute("onclick","addBlock("+f+",'audio')");i.setAttribute("class","blockbtn addbtn");i.innerHTML="audio";var c=document.createElement("button");c.setAttribute("onclick","addBlock("+f+",'video')");c.setAttribute("class","blockbtn addbtn");c.innerHTML="video";var h=document.createElement("button");h.setAttribute("onclick","addBlock("+f+",'slide')");h.setAttribute("class","blockbtn addbtn");h.innerHTML="slides";var d=document.createElement("button");d.setAttribute("onclick","addBlock("+f+",'xsvgs')");d.setAttribute("class","blockbtn addbtn");d.innerHTML="svg";var e=document.createElement("button");e.setAttribute("onclick","addBlock("+f+",'title')");e.setAttribute("class","blockbtn addbtn");e.innerHTML="title";var k=document.createElement("button");k.setAttribute("id","d"+f);k.setAttribute("onclick","deleteBlock("+f+")");k.setAttribute("class","blockbtn delbtn");k.style.visibility="hidden";k.innerHTML="&darr;";j.appendChild(a);j.appendChild(g);j.appendChild(m);j.appendChild(l);j.appendChild(b);j.appendChild(i);j.appendChild(c);j.appendChild(h);j.appendChild(e);j.appendChild(k);return j}function makeSpace(b,e){var a=e;while(b<a){var c=a+1;var d=blockButtons(c);document.getElementById("b"+a).parentNode.replaceChild(d,document.getElementById("b"+a));document.getElementById("a"+a).setAttribute("id","a"+c);document.getElementById(a).setAttribute("id",c);a--}}function insertBlock(g,d,b,c){var f=document.getElementById("blocks");var e=document.createElement("div");e.setAttribute("class","block");e.setAttribute("id",b);e.appendChild(g);e.appendChild(d);if(b<=c){var a=document.getElementById("blocks").children[b];document.getElementById("blocks").insertBefore(e,a)}else{f.appendChild(e)}}function createBlock(c,h){var f=countBlocks();if(c<f){makeSpace(c,f)}var b=c+1;var e="";var g=insertContent(b,h,e);var a=blockButtons(b);insertBlock(g,a,b,f);var d=0;while(d<=f){document.getElementById("d"+d).style.visibility="visible";d++}}function addBlock(a,d){if(d==="xtext"){createBlock(a,d);var c=document.getElementById("a"+(a+1)).childNodes[0];var b=c.contentDocument;b.designMode="on";saveBlocks(false)}else{if(["xcode","xmath","latex","title"].indexOf(d)>-1){createBlock(a,d);saveBlocks(false)}else{if(["image","audio","video","slide","xsvgs"].indexOf(d)>-1){uploadMedia(a+1,d)}}}}function closeSpace(b,e){var a=b;while(a<e){var c=a+1;var d=blockButtons(a);document.getElementById("b"+c).parentNode.replaceChild(d,document.getElementById("b"+c));document.getElementById("a"+c).setAttribute("id","a"+a);document.getElementById(c).setAttribute("id",a);a++}}function removeBlock(a){var b=document.getElementById(a);b.parentNode.removeChild(b)}function deleteBlock(b){var d=countBlocks();var a=b+1;removeBlock(a);if(a<d){closeSpace(a,d)}var c=0;d=countBlocks();while(c<d){document.getElementById("d"+c).style.visibility="visible";c++}document.getElementById("d"+c).style.visibility="hidden";saveBlocks(false)}function uploadMedia(b,c){var a=document.getElementById("file-select");switch(c){case"image":a.setAttribute("accept",".bmp,.bmp2,.bmp3,.jpeg,.jpg,.pdf,.png,.svg");break;case"audio":a.setAttribute("accept",".aac,.aiff,.m4a,.mp3,.ogg,.ra,.wav,.wma");break;case"video":a.setAttribute("accept",".avi,.flv,.mov,.mp4,.mpeg,.ogg,.rm,.webm,.wmv");break;case"xsvgs":a.setAttribute("accept",".svg");break;case"slide":a.setAttribute("accept",".pdf,.ppt,.pptx,.pps,.ppsx");break;default:a.setAttribute("accept","")}a.click();a.onchange=function(){var e=a.files[0];var h=false;var d=false;var f;if(a.files.length>0){if(e.size>4294967295){h=true;f="Files Must Be Less Than 4.3 GB"}}else{d=true}if(d){console.log("nofile")}else{if(h){alertify.alert(f)}else{createBlock(b-1,c);var g=new Promise(function(o,n){var p=new FormData();p.append("media",e,e.name);var k=document.getElementsByName("pageid")[0].value;var l=createURL("/uploadmedia?pid="+k+"&btype="+c);var m=new XMLHttpRequest();m.open("POST",l,true);m.upload.onloadstart=function(q){progressInitialize("Uploading...",q.total)};m.upload.onprogress=function(q){if(q.lengthComputable){progressUpdate(q.loaded)}};m.upload.onloadend=function(q){progressFinalize("Uploaded",q.total)};function j(q){if(typeof j.track==="undefined"||j.track===0){j.track=1;return 1}else{if(q){j.track=0;return 0}else{j.track++}}return j.track}function i(q){if(typeof i.prev==="undefined"){i.prev=0;i.curr=q}else{if(i.curr!==q){i.prev=i.curr;i.curr=q}}return[i.prev,i.curr]}m.onprogress=function(s){var q=i(m.responseText.length);var r=j(false);var t=m.responseText.slice(q[0],q[1]).split(",");if(r===1){progressInitialize("Converting...",t[t.length-1])}else{progressUpdate(t[t.length-1])}};m.onloadend=function(r){var q=i(m.responseText.length);var s=m.responseText.slice(q[0],q[1]).split(",");progressFinalize("Not Saved",s[s.length-1]);j(true)};m.onreadystatechange=function(){if(m.readyState===XMLHttpRequest.DONE){if(m.status===200){if(m.responseText==="err"){n("err")}else{if(m.responseText==="convertmediaerr"){n("convertmediaerr")}else{if(m.responseText==="nouploadloggedout"){deleteBlock(b-1);alertify.alert("You Can't Upload Media Because You Are Logged Out. Log Back In On A Separate Page, Then Return Here & Try Again.");n("err")}else{var q=i(m.responseText.length);var r=m.responseText.slice(q[0],q[1]).split(",");i(0);i(0);o(r[r.length-1])}}}}else{alertify.alert("Error:"+m.status+": Please Try Again");n("err")}}};m.send(p)});g.then(function(l){if(c==="image"){var k=document.getElementById("a"+b).childNodes[0];k.src=l}else{if(c==="audio"||c==="video"){var j=document.getElementById("a"+b).childNodes[0].childNodes[0];j.src=l;j.parentNode.load()}else{if(c==="xsvgs"){var i=document.getElementById("a"+b).childNodes[0];i.setAttribute("data-link",l);getLocalLinkContent(l).then(function(n){var m=n.split("\n");i.innerHTML=m[1]},function(m){})}else{if(c==="slide"){PDFJS.getDocument(l).then(function(m){pdfObjects[l]=m;var n=document.getElementById("a"+b).childNodes[0];n.setAttribute("id",l);renderPDF(m,1,n)})}}}}saveBlocks(false)},function(i){if(i==="convertmediaerr"){alertify.log("There was an error with that media format. Please try a different file type.")}else{console.log("uploadMedia() promise error")}})}}this.value=null}}function login(){var b=createURL("/login");var e=document.getElementsByName("username-login")[0].value;var a=document.getElementsByName("password-login")[0].value;var c;c=new XMLHttpRequest();var d="username="+e+"&password="+a;c.open("POST",b,true);c.setRequestHeader("Content-type","application/x-www-form-urlencoded");c.onreadystatechange=function(){if(c.readyState===XMLHttpRequest.DONE){if(c.status===200){if(c.responseText==="loggedin"){emptyDiv("content");pageHome()}else{if(c.responseText==="incorrect"){alertify.alert("The Passowrd Was Incorrect")}else{if(c.responseText==="notfound"){alertify.alert("The Username Could Not Be Found")}else{alertify.alert("An Unknown Error Occurred")}}}}else{alertify.alert("Error:"+c.status+": Please Try Again Later")}}};c.send(d)}function signup(){var d=createURL("/signup");var h=document.getElementsByName("username-signup")[0].value;var c=document.getElementsByName("email-signup")[0].value;var a=document.getElementsByName("phone-signup")[0].value;var b=document.getElementsByName("password-signup")[0].value;var f=document.getElementsByName("password-signup-check")[0].value;if(b!==f){}var e;e=new XMLHttpRequest();var g="username="+h+"&email="+c+"&phone="+a+"&password="+b;e.open("POST",d,true);e.setRequestHeader("Content-type","application/x-www-form-urlencoded");e.onreadystatechange=function(){if(e.readyState===XMLHttpRequest.DONE){if(e.status===200){if(e.responseText==="success"){emptyDiv("content");pageHome()}else{if(e.responseText==="exists"){alertify.alert("That Username Already Exists.\nPlease Choose A Different One.")}else{alertify.alert("An Unknown Error Occurred")}}}else{alertify.alert("Error:"+e.status+": Please Try Again Later")}}};e.send(g)}function logout(){var a=createURL("/logout");var b;b=new XMLHttpRequest();b.open("POST",a,true);b.setRequestHeader("Content-type","application/x-www-form-urlencoded");b.onreadystatechange=function(){if(b.readyState===XMLHttpRequest.DONE){if(b.status===200){if(b.responseText==="loggedout"){emptyDiv("content");pageLanding()}else{alertify.alert("An Unknown Error Occurred")}}else{alertify.alert("Error:"+b.status+": Please Try Again Later")}}};b.send()}function createpage(){var c=createURL("/createpage");var b=document.getElementsByName("pagename-create")[0].value;var e=document.getElementById("select-subject").value;var f=document.getElementById("select-category").value;var a=document.getElementById("select-topic").value;if(b===""||e===""||f===""||a===""){alertify.alert("Please Choose A Topic & Enter A Page Name.")}else{var d;d=new XMLHttpRequest();e=urlEscape(e);f=urlEscape(f);a=urlEscape(a);var g="pagename="+b+"&subject="+e+"&category="+f+"&topic="+a;d.open("POST",c,true);d.setRequestHeader("Content-type","application/x-www-form-urlencoded");d.onreadystatechange=function(){if(d.readyState===XMLHttpRequest.DONE){if(d.status===200){if(d.responseText==="pageexists"){alertify.alert("You Already Have A Page With That Name.")}else{if(d.responseText==="nocreateloggedout"){alertify.alert("Unable To Create Page. You Are Logged Out.")}else{if(d.responseText==="err"){alertify.alert("An Error Occured. Please Try Again Later.")}else{window.location=createURL("/editpage?page="+d.responseText)}}}}else{alertify.alert("Error:"+d.status+": Please Try Again Later")}}};d.send(g)}}function deletePage(a){var b=createURL("/deletepage");var c;c=new XMLHttpRequest();var d="pid="+a;c.open("POST",b,true);c.setRequestHeader("Content-type","application/x-www-form-urlencoded");c.onreadystatechange=function(){if(c.readyState===XMLHttpRequest.DONE){if(c.status===200){if(c.responseText==="success"){var g=document.getElementById("page-select");var f=g.length;var h;for(var e=0;e<f;e++){if(g.options[e].value===a){h=g.options[e]}}g.removeChild(h)}else{if(c.responseText==="nodeleteloggedout"){alertify.alert("Could Not Delete Page. You Are Logged Out.")}else{alertify.alert("There Was A Problem Deleting The Page.")}}}else{alertify.alert("Error:"+c.status+": Please Try Again Later")}}};c.send(d)}function getPages(){var a=new Promise(function(e,d){var b=createURL("/getpages");var c;c=new XMLHttpRequest();c.open("POST",b,true);c.setRequestHeader("Content-type","application/x-www-form-urlencoded");c.onreadystatechange=function(){if(c.readyState===XMLHttpRequest.DONE){if(c.status===200){if(c.responseText==="err"){d("err")}else{e(c.responseText)}}else{alertify.alert("Error:"+c.status+": Please Try Again Later")}}};c.send()});return a}function getSubjects(){var a=new Promise(function(e,d){var b=createURL("/getsubjects");var c;c=new XMLHttpRequest();c.open("POST",b,true);c.setRequestHeader("Content-type","application/x-www-form-urlencoded");c.onreadystatechange=function(){if(c.readyState===XMLHttpRequest.DONE){if(c.status===200){if(c.responseText==="err"){d("err")}else{e(c.responseText)}}else{alertify.alert("Error:"+c.status+": Please Try Again Later")}}};c.send()});return a}function saveBlocks(g){var p;if(g===false){p=0;document.getElementById("savestatus").innerHTML="Not Saved"}else{p=1;document.getElementById("savestatus").innerHTML="Saved"}document.getElementsByName("statusid")[0].setAttribute("value",p);var r=[];var e=[];var l=countBlocks();var o=1;if(l>0){var m=0;while(l>=o){var k=document.getElementById("a"+o).className;r[m]=k;if(k==="xtext"){e[m]=document.getElementById("a"+o).children[0].contentDocument.getElementsByTagName("body")[0].innerHTML;e[m]=parseBlock(k,e[m])}else{if(k==="xcode"){e[m]=document.getElementById("a"+o).children[0].innerHTML;e[m]=parseBlock(k,e[m])}else{if(k==="latex"||k==="xmath"){e[m]=document.getElementById("a"+o).children[1].innerHTML.replace(/\\/g,"\\\\");e[m]=parseBlock(k,e[m])}else{if(k==="image"){var a=document.getElementById("a"+o).children[0].src;e[m]=a.replace(location.href.substring(0,location.href.lastIndexOf("/")+1),"")}else{if(k==="audio"||k==="video"){var h=document.getElementById("a"+o).children[0].children[0].src;e[m]=h.replace(location.href.substring(0,location.href.lastIndexOf("/")+1),"")}else{if(k==="xsvgs"){var s=document.getElementById("a"+o).childNodes[0].getAttribute("data-link");e[m]=s.replace(location.href.substring(0,location.href.lastIndexOf("/")+1),"")}else{if(k==="slide"){var c=document.getElementById("a"+o).children[0].id;e[m]=c.replace(location.href.substring(0,location.href.lastIndexOf("/")+1),"")}else{if(k==="title"){e[m]=document.getElementById("a"+o).children[0].value;e[m]=parseBlock(k,e[m])}}}}}}}}m++;o++}var f=r.join();var n=e.join()}var d=createURL("/saveblocks");var j=document.getElementsByName("pageid")[0].value;var b=document.getElementsByName("pagename")[0].value;var t;t=new XMLHttpRequest();if(g!==false){t.upload.onprogress=function(i){if(i.lengthComputable){progressUpdate(i.loaded)}};t.upload.onloadstart=function(i){progressInitialize("Saving...",i.total)};t.upload.onloadend=function(i){progressFinalize("Saved",i.total)}}var q="mediaType="+f+"&mediaContent="+n+"&pid="+j+"&pagename="+b+"&tabid="+p;t.open("POST",d,true);t.setRequestHeader("Content-type","application/x-www-form-urlencoded");t.onreadystatechange=function(){if(t.readyState===XMLHttpRequest.DONE){if(t.status===200){if(t.responseText==="blockssaved"){}else{if(t.responseText==="nosaveloggedout"){alertify.alert("You Can't Save This Page Because You Are Logged Out. Log In On A Separate Page, Then Return Here & Try Again.")}else{alertify.alert("An Unknown Save Error Occurred")}}}else{alertify.alert("Error:"+t.status+": Please Try Again Later")}}};t.send(q)}function revertBlocks(){var c=createURL("/revert");var a=document.getElementsByName("pageid")[0].value;var b=document.getElementsByName("pagename")[0].value;var d;d=new XMLHttpRequest();var e="pid="+a;d.open("POST",c,true);d.setRequestHeader("Content-type","application/x-www-form-urlencoded");d.onreadystatechange=function(){if(d.readyState===XMLHttpRequest.DONE){if(d.status===200){if(d.responseText==="nopid"){alertify.alert("This Page Is Not Meant To Be Visited Directly.")}else{if(d.responseText==="norevertloggedout"){alertify.alert("Revert Error. You Are Not Logged In.")}else{if(d.responseText==="err"){alertify.alert("An Error Occured. Please Try Again Later")}else{emptyDiv("content");pageEdit(a+","+b+d.responseText)}}}}else{alertify.alert("Error:"+d.status+": Please Try Again Later")}}};d.send(e)}function saveProfileInfo(e,a){var g="";var d=0;var f=a.length;if(f>0){g=a[d]+"="+document.getElementsByName(a[d])[0].value;d++}while(d<f){g+="&"+a[d]+"="+document.getElementsByName(a[d])[0].value;d++}var b=createURL("/saveprofile");var c;c=new XMLHttpRequest();c.open("POST",b,true);c.setRequestHeader("Content-type","application/x-www-form-urlencoded");c.onreadystatechange=function(){if(c.readyState===XMLHttpRequest.DONE){if(c.status===200){if(c.responseText==="profilesaved"){e.style="background-color: #00ffe1";alertify.log("Saved!","success")}else{if(c.responseText==="nosaveloggedout"){e.style="background-color: #e83e3e";alertify.alert("You Can't Save Because You Are Logged Out. Log In On A Separate Page, Then Return Here & Try Again.")}else{e.style="background-color: #e83e3e";alertify.alert("An Unknown Error Occurred")}}}else{alertify.alert("Error:"+c.status+": Please Try Again Later")}}};c.send(g)}function autosaveTimer(a){var b=getUserFields(["autosave"]);b.then(function(d){var e=d.autosave;if(e!=0){var g=e;var c;var f;setInterval(function(){c=parseInt(g/60,10);f=parseInt(g%60,10);c=c<10?"0"+c:c;f=f<10?"0"+f:f;a.textContent=c+":"+f;if(--g<0){saveBlocks(true);g=e}},1000)}else{a.style.visibility="hidden";a.style.display="none"}},function(c){alertify.alert("Error. Auto Save Could Not Be Initiated.")})}function getLocalLinkContent(a){var b=new Promise(function(f,e){var c=createURL("/"+a);var d;d=new XMLHttpRequest();d.open("GET",c,true);d.setRequestHeader("Content-type","application/x-www-form-urlencoded");d.onreadystatechange=function(){if(d.readyState===XMLHttpRequest.DONE){if(d.status===200){if(d.responseText==="err"){e("err")}else{f(d.responseText)}}else{e("err")}}};d.send()});return b}function getUserFields(a){var b=new Promise(function(f,e){var g="fields="+a.join(",");var c=createURL("/getprofiledata");var d;d=new XMLHttpRequest();d.open("POST",c,true);d.setRequestHeader("Content-type","application/x-www-form-urlencoded");d.onreadystatechange=function(){if(d.readyState===XMLHttpRequest.DONE){if(d.status===200){if(d.responseText==="err"){e("err")}else{if(d.responseText==="noprofiledataloggedout"){e("noprofiledataloggedout")}else{f(JSON.parse(d.responseText))}}}else{e("err")}}};d.send(g)});return b};